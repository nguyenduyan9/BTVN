(self.wpJsonpPcmallRating=self.wpJsonpPcmallRating||[]).push([[798],{7798:(e,t,r)=>{"use strict";r.d(t,{Z:()=>Me});var n=r(3804),a=r.n(n),o=r(5462),s=r.n(o),i=r(4857),l=r(5325),c=r(6775),m=r(2168),p=r.n(m),u=r(5518),d=r(8683),h=r(1256),g=r(9151),_=r(5776),f=r(2451),E=r(6070),w=r(2028),v=r(717),C=r(2360),x=r(965),k=r(6704),b=r(2437),y=r(7339),R=r(8062),I=r(2954),L=r(9186),N=r(3436),M=r(7289),S=r(4074),F=r(7811),B=r(9241),P=r(3549),T=r(26);const{t:Z}=k.I18n,A=({isAnonymous:e,authorPic:t,shopId:r})=>{const a=n.createElement(M.Z,{imgSrc:(0,T.Jn)(t,!0)});if(e)return n.createElement("div",{className:"shopee-product-rating__avatar"},a);{const e=P.Ri.getUrl({shopId:r});return n.createElement(c.Link,{to:e,className:"shopee-product-rating__avatar"},a)}},O=({isAnonymous:e,authorName:t,shopId:r})=>{const a=null==t?Z("text_shopee_user"):t;if(e)return n.createElement("div",{className:"shopee-product-rating__author-name"},a);{const e=P.Ri.getUrl({shopId:r});return n.createElement(c.Link,{className:"shopee-product-rating__author-name",to:e},a)}},H=({star:e})=>n.createElement("div",{className:"shopee-product-rating__rating"},[1,2,3,4,5].map(((t,r)=>r<e?n.createElement(F.Z,{key:r,classNames:["icon-rating-solid--active"]}):n.createElement(B.Z,{key:r})))),U=({content:e,isHidden:t})=>t?null:e?n.createElement("div",{className:"shopee-product-rating__content"},e):null,D=({images:e})=>n.createElement("div",{className:"shopee-product-rating__image-list-wrapper"},n.createElement(S.Z,{urlList:e})),G=({modelName:e,commentTime:t,region:r,isUserRating:a})=>{const o=r?` ${r} | `:"";return n.createElement("div",{className:"shopee-product-rating__time"},o?n.createElement("svg",{width:"8",height:"10",viewBox:"0 0 8 10",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M4.36872 8.81893C4.28492 8.93416 4.15084 9 4 9C3.84916 9 3.71508 8.93416 3.63128 8.81893C2.82682 7.76543 1 5.23045 1 3.9465C1 2.31687 2.34078 1 4 1C5.65922 1 7 2.31687 7 3.9465C7 5.21399 5.17318 7.76543 4.36872 8.81893Z",stroke:"black",strokeOpacity:"0.54",strokeWidth:"0.8"}),n.createElement("path",{d:"M5 4C5 3.44186 4.55814 3 4 3C3.44186 3 3 3.44186 3 4C3 4.55814 3.44186 5 4 5C4.55814 5 5 4.55814 5 4Z",fill:"black",fillOpacity:"0.26"})):null,e&&!a?`${o}${t} | ${Z("label_variation")}: ${e}`:`${o}${t}`)},$=()=>n.createElement("svg",{width:"14px",height:"13px",viewBox:"0 0 14 13",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n.createElement("defs",null),n.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},n.createElement("g",{id:"Product-Ratings-Working",transform:"translate(-245.000000, -855.000000)",fillRule:"nonzero"},n.createElement("g",{transform:"translate(155.000000, 92.000000)"},n.createElement("g",{transform:"translate(40.000000, 184.000000)"},n.createElement("g",{transform:"translate(0.000000, 326.000000)"},n.createElement("g",{transform:"translate(50.000000, 253.000000)"},n.createElement("g",null,n.createElement("path",{d:"M0,12.7272727 L2.54545455,12.7272727 L2.54545455,5.09090909 L0,5.09090909 L0,12.7272727 Z M14,5.72727273 C14,5.02727273 13.4272727,4.45454545 12.7272727,4.45454545 L8.71818182,4.45454545 L9.35454545,1.52727273 L9.35454545,1.33636364 C9.35454545,1.08181818 9.22727273,0.827272727 9.1,0.636363636 L8.4,0 L4.2,4.2 C3.94545455,4.39090909 3.81818182,4.70909091 3.81818182,5.09090909 L3.81818182,11.4545455 C3.81818182,12.1545455 4.39090909,12.7272727 5.09090909,12.7272727 L10.8181818,12.7272727 C11.3272727,12.7272727 11.7727273,12.4090909 11.9636364,11.9636364 L13.8727273,7.44545455 C13.9363636,7.31818182 13.9363636,7.12727273 13.9363636,7 L13.9363636,5.72727273 L14,5.72727273 C14,5.79090909 14,5.72727273 14,5.72727273 Z"}))))))))),j=()=>n.createElement("svg",{width:"4px",height:"16px",viewBox:"0 0 4 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n.createElement("defs",null),n.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-1301.000000, -550.000000)",fill:"#CCCCCC"},n.createElement("g",{transform:"translate(155.000000, 92.000000)"},n.createElement("g",{transform:"translate(40.000000, 184.000000)"},n.createElement("g",{transform:"translate(0.000000, 161.000000)"},n.createElement("g",null,n.createElement("g",{transform:"translate(50.000000, 2.000000)"},n.createElement("path",{d:"M1058,122.2 C1056.895,122.2 1056,123.096 1056,124.2 C1056,125.306 1056.895,126.202 1058,126.202 C1059.104,126.202 1060,125.306 1060,124.2 C1060,123.096 1059.104,122.2 1058,122.2 M1058,116.6 C1056.895,116.6 1056,117.496 1056,118.6 C1056,119.706 1056.895,120.602 1058,120.602 C1059.104,120.602 1060,119.706 1060,118.6 C1060,117.496 1059.104,116.6 1058,116.6 M1058,111 C1056.895,111 1056,111.896 1056,113 C1056,114.106 1056.895,115.002 1058,115.002 C1059.104,115.002 1060,114.106 1060,113 C1060,111.896 1059.104,111 1058,111"}))))))))),K=()=>n.createElement("svg",{width:"16",height:"11",viewBox:"0 0 16 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.24241 8.8C6.4909 8.8 5.04847 7.26 5.04847 5.39C5.04847 3.52 6.4909 1.98 8.24241 1.98C9.99393 1.98 11.4364 3.52 11.4364 5.39C11.4364 7.26 9.99393 8.8 8.24241 8.8ZM8.24241 3.08C7.00605 3.08 6.07878 4.18 6.07878 5.39C6.07878 6.6 7.00605 7.7 8.24241 7.7C9.47878 7.7 10.406 6.6 10.406 5.39C10.406 4.18 9.47878 3.08 8.24241 3.08ZM8.24241 10.78C5.1515 10.78 2.26665 8.91 0.61817 5.72L0.412109 5.39L0.51514 5.06C2.26665 1.87 5.1515 0 8.24241 0C11.3333 0 14.2182 1.87 15.8667 5.06L15.9697 5.39L15.8667 5.72C14.2182 8.8 11.3333 10.78 8.24241 10.78Z",fill:"black",fillOpacity:"0.26"})),V=()=>n.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M12.6538 13.3316V10.3335H13.6353V13.4992C13.6353 14.1384 13.1171 14.6668 12.4779 14.6668H2.49076C1.85155 14.6668 1.33337 14.1384 1.33337 13.4992V2.50112C1.33337 1.86193 1.85157 1.3335 2.49076 1.3335H9.27574V2.33541H2.64814C2.46404 2.33541 2.31481 2.48465 2.31481 2.66875V13.3316C2.31481 13.5157 2.46404 13.6649 2.64814 13.6649H12.3205C12.5046 13.6649 12.6538 13.5157 12.6538 13.3316Z",fill:"#EE4D2D"}),n.createElement("path",{d:"M13.7042 2.47157C13.4438 2.21122 13.0217 2.21122 12.7614 2.47157L5.30439 9.92856C5.24787 9.98508 5.20197 10.0513 5.16889 10.1241L4.40823 11.7976C4.28077 12.0779 4.56922 12.3664 4.84961 12.2389L6.52307 11.4783C6.59585 11.4452 6.66208 11.3993 6.71861 11.3428L14.1756 3.88578C14.4359 3.62543 14.4359 3.20332 14.1756 2.94297L13.7042 2.47157Z",fill:"#EE4D2D"}));function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},W.apply(this,arguments)}const z=e=>a().createElement("svg",W({width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),a().createElement("g",{filter:"url(#filter0_i)"},a().createElement("rect",{width:"18",height:"18",rx:"9",fill:"white"})),a().createElement("rect",{x:"0.5",y:"0.5",width:"17",height:"17",rx:"8.5",stroke:"black",strokeOpacity:"0.14"}),a().createElement("defs",null,a().createElement("filter",{id:"filter0_i",x:"0",y:"0",width:"18",height:"19",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},a().createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a().createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),a().createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a().createElement("feOffset",{dy:"2"}),a().createElement("feGaussianBlur",{stdDeviation:"0.5"}),a().createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a().createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09 0"}),a().createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})))),J=e=>a().createElement("svg",W({width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),a().createElement("g",{filter:"url(#filter0_i)"},a().createElement("rect",{width:"18",height:"18",rx:"9",fill:"white"})),a().createElement("rect",{x:"0.5",y:"0.5",width:"17",height:"17",rx:"8.5",stroke:"black",strokeOpacity:"0.14"}),a().createElement("rect",{width:"18",height:"18",rx:"9",fill:"#FF5722"}),a().createElement("g",{filter:"url(#filter1_d)"},a().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 13C11.2091 13 13 11.2091 13 9C13 6.79086 11.2091 5 9 5C6.79086 5 5 6.79086 5 9C5 11.2091 6.79086 13 9 13Z",fill:"white"})),a().createElement("defs",null,a().createElement("filter",{id:"filter0_i",x:"0",y:"0",width:"18",height:"19",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},a().createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a().createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),a().createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a().createElement("feOffset",{dy:"2"}),a().createElement("feGaussianBlur",{stdDeviation:"0.5"}),a().createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a().createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09 0"}),a().createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})),a().createElement("filter",{id:"filter1_d",x:"3",y:"5",width:"12",height:"12",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},a().createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a().createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a().createElement("feOffset",{dy:"2"}),a().createElement("feGaussianBlur",{stdDeviation:"1"}),a().createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.02 0"}),a().createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),a().createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})))),q=e=>a().createElement("svg",W({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),a().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1C4.13401 1 1 4.13401 1 8C1 11.866 4.13401 15 8 15Z",stroke:"#FF424F"}),a().createElement("rect",{x:"6.06055",y:"5",width:"7",height:"1.5",rx:"0.75",transform:"rotate(45 6.06055 5)",fill:"#FF424F"}),a().createElement("rect",{width:"7",height:"1.5",rx:"0.75",transform:"matrix(-0.707107 0.707107 0.707107 0.707107 9.94971 5)",fill:"#FF424F"})),X=e=>a().createElement("svg",W({width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),a().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.9938 11.4383L11.996 11.438L10.996 3.438L10.9938 3.43825C10.9634 3.18844 10.7516 3.00044 10.5 3H8.7685L8.74475 2.64275H8.7445C8.6875 1.17625 7.48025 0 6 0C4.51975 0 3.3125 1.17625 3.2555 2.64275H3.255L3.23125 3H1.5C1.245 3 1.037 3.1915 1.00625 3.43825L1.004 3.438L0.004 11.438L0.00625 11.4383L0.00420502 11.4537C0.00210023 11.4689 0 11.4841 0 11.5C0 11.7761 0.223858 12 0.5 12H11.5C11.7761 12 12 11.7761 12 11.5C12 11.4841 11.9979 11.4689 11.9958 11.4537L11.9958 11.4537L11.9938 11.4383ZM4.25274 2.71122H4.25199C4.27424 1.76547 5.04899 1.00247 5.99999 1.00247C6.95099 1.00247 7.72574 1.76547 7.74799 2.71122H7.74724L7.76649 3.00247H4.23349L4.25274 2.71122ZM3.00324 6.46947L3.00099 6.46922L3.16474 4.00247H1.94124L1.06624 11.0025H10.9335L10.0585 4.00247H8.83499L8.99899 6.46922L8.99674 6.46947C8.99705 6.47398 8.99765 6.47845 8.99825 6.48293C8.99912 6.48937 8.99999 6.49584 8.99999 6.50247C8.99715 6.7697 8.78438 6.9873 8.51728 6.99614C8.25019 7.00498 8.02349 6.80193 8.00299 6.53547L8.00099 6.53572L7.83274 4.00247H4.16699L3.99899 6.53572L3.99674 6.53547C3.99441 6.71605 3.89466 6.88126 3.73594 6.9674C3.57722 7.05355 3.38433 7.04716 3.23165 6.95071C3.07898 6.85426 2.99037 6.68281 2.99999 6.50247C2.99999 6.49584 3.00086 6.48937 3.00173 6.48293C3.00233 6.47845 3.00293 6.47398 3.00324 6.46947Z",fill:"#E79911"}));var Q=r(870),Y=r(3091),ee=r(1720);const te="ID"===k.Env.getLocale(),re=["rating_report_reason_rude","rating_report_reason_pornographic","rating_report_reason_spam","rating_report_reason_exposing","rating_report_reason_advertisement","rating_report_reason_misleading","rating_report_reason_other"],ne="X43ooh",ae="-39S0d",oe="nCzOIn",se="iZm6yc",ie="lpg6hM",le="NwK2tn",ce="_0rj+Kz",me="X74D0S",pe="_1oHKe7";function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ue.apply(this,arguments)}const{t:de}=k.I18n,he=0,ge=1,_e=2,fe=27000006,Ee=27000007;let we=[];const ve=function(e){const t=a().useRef(null),[r,o]=a().useState(-1),[s,i]=a().useState(""),[l,c]=a().useState(""),[m,p]=a().useState({code:he,message:"",submitting:void 0}),u=(0,Y.Z)(e.trackingType,e),d=(0,ee.Z)(e.trackingType,{});a().useEffect((()=>(u(t.current),()=>{we.forEach((e=>window.clearTimeout(e))),we=[]})),[]);const h=a().useMemo((()=>void 0!==m.submitting?!!m.submitting:-1===r||!!(r===re.length-1&&!s||te&&r===re.length-2&&!l)),[r,s,m.submitting,l]),g=a().useCallback((e=>{o(e)}),[]),_=a().useCallback((e=>{i(e)}),[]),f=a().useCallback((e=>{c(e)}),[]),E=a().useCallback((()=>{const e=window.setTimeout((()=>{p({code:he,message:"",submitting:void 0})}),3e3);we.push(e)}),[]),w=a().useCallback((async()=>{if(h)return;if(d({targetData:ue({},e)}),!window.navigator.onLine)return p({message:de("rating_submit_network_abnormal"),code:_e,submitting:!0}),void E();p({code:he,message:"",submitting:!0});const{cmtId:t,shopId:n,itemId:a}=e,o=de(re[r]),{error:i,be_error:c}=await e.reportRating(t,n,a,function(e,t,r){return e===re.length-1||e===re.length-2&&te&&t?`${r}:${t}`:r}(r,r===re.length-1?s:l,o));if(i)return p(c===fe?{submitting:!0,message:de("rating_report_frequently_toast"),code:fe}:c===Ee?{submitting:!0,message:de("rating_report_restriction_toast"),code:fe}:{submitting:!0,message:de("rating_submit_network_abnormal"),code:ge}),void E();e.closePopupForm(!0)}),[h,r,s,l]);return a().createElement(Q.Z,{title:de("rating_report_page_title"),showCancelButton:!0,showSubmitButton:!0,showOKButton:!1,textSubmit:de("rating_report_page_submit"),cancelButtonText:de("rating_report_page_cancel"),disableSubmit:h,formExtraClassNames:ne,onSubmit:w,onCancel:()=>e.closePopupForm(!1)},a().createElement("div",{className:ae,ref:t},a().createElement("div",{className:oe},de("rating_report_page_text")),m.code!==he&&a().createElement("div",{className:me},a().createElement(q,{className:pe}),m.message),a().createElement("ul",{className:se},re.map(((e,t)=>a().createElement(n.Fragment,{key:t},a().createElement("li",{onClick:()=>g(t),className:ie},r===t?a().createElement(J,{className:le}):a().createElement(z,{className:le}),a().createElement("div",{style:{flex:1}},de(e))),te&&t===re.length-2&&r===re.length-2?a().createElement("div",{className:ce},a().createElement("input",{type:"text",placeholder:de("rating_report_reason_other_prompt"),onChange:e=>f(e.target.value),value:l,maxLength:300})):null,t===re.length-1&&r===re.length-1?a().createElement("div",{className:ce},a().createElement("input",{type:"text",placeholder:de("rating_report_reason_other_prompt"),onChange:e=>_(e.target.value),value:s,maxLength:300})):null))))))},{t:Ce}=k.I18n;function xe({isProductRatingPage:e=!1}){const t=Ce(e?"low_rating_reminder_product":"low_rating_reminder_shop");return a().createElement(a().Fragment,null,a().createElement("span",{className:"rating-tips-icon"},a().createElement("div",{className:"shopee-product-rating__tips"},a().createElement("span",{className:"shopee-product-rating__tipsText"},t))))}var ke=r(6160);const{t:be}=k.I18n,ye=({productItem:e})=>a().createElement(c.Link,{to:ke.Z.getUrl({seoName:e.name,shopId:e.shopid,itemId:e.itemid})},a().createElement("div",{className:"cZ0z9J"},a().createElement(E.$3,{alt:"product-image",id:e.image,thumbnail:!0}),a().createElement("div",{className:"uEm7h0"},a().createElement("span",{className:"AVCMWT"},e.name),e.model_name?a().createElement("span",{className:"LqDAN-"},be("label_variation"),": ",e.model_name):null))),Re=e=>{var t,r;const{followUp:n}=e,o=[...n.videos||[],...(null==(t=n.images)?void 0:t.map((e=>e.image_id)))||[]],s=n.after_days,i=null==(r=n.follow_up_reply)?void 0:r.comment;return a().createElement("div",null,a().createElement("div",{className:"shopee-product-rating__follow_up_content_title"},1===s?k.I18n.t("one_day_update",{period:s}):k.I18n.t("some_days_update",{period:s})),a().createElement(U,{content:n.comment||""}),o.length?a().createElement(D,{images:o}):null,i?a().createElement(C.Z,{titleText:k.I18n.t("pr_order_purchase_label_seller_response"),response:i,isHidden:!1}):null)},{t:Ie}=k.I18n,{localizeCompactNumber:Le}=(0,u.getUtilsByCountry)((0,d.Kd)(),(0,d.of)());class Ne extends n.Component{constructor(e){var t;super(e),t=this,this._nodeReportMenuButton=null,this.handleLikeRating=async function(){if(t.props.accountInfoProgress!==L.Z.INIT&&t.props.accountInfoProgress!==L.Z.REQ)if(t.props.accountStatus!==f.d.LOGGED_IN)t.props.history.push((0,R.FK)(y.D_.getUrl(),{next:window.location.href}));else{const{rating:e,accountInfo:r}=t.props;if(e)if(t.state.liked){const n=await t.props.unlikeRating(e.cmtid,e.shopid,e.itemid,e.like_count||0,r.userId);t.setState({liked:!1,like_count:n})}else{const n=await t.props.likeRating(e.cmtid,e.shopid,e.itemid,e.like_count||0,r.userId);t.setState({liked:!0,like_count:n})}}},this.handleEdit=()=>{(0,N.S7)({commentId:this.props.rating.cmtid,orderId:this.props.rating.orderid,userId:this.props.accountInfo.userId,shopId:this.props.shopId,isSeller:!1,showPopup:this.context.showPopup,dismissPopup:this.context.dismissPopup,fromSource:"myRating",callback:e=>{this.props.updateMyReview(this.props.rating.cmtid,e,this.props.accountInfo.userId)}})},this.handleFollow=()=>{(0,N.hR)({commentId:this.props.rating.cmtid,orderId:this.props.rating.orderid,userId:this.props.accountInfo.userId,shopId:this.props.shopId,isSeller:!1,showPopup:this.context.showPopup,dismissPopup:this.context.dismissPopup,fromSource:"myRating",callback:e=>{this.props.updateMyReview(this.props.rating.cmtid,e,this.props.accountInfo.userId)}})},this.closePopupForm=e=>{this.context.dismissPopup(),e&&this.onReported()},this.onReported=()=>{this.toastAbuseReportSuccess(!0)},this.showReportForm=()=>{const{rating:e,showProducts:t}=this.props;this.context.showPopup(n.createElement(ve,{closePopupForm:this.closePopupForm,reportRating:this.props.reportRating,cmtId:e.cmtid,shopId:e.shopid,itemId:e.itemid,trackingType:t?"ShopRating.ReportModal":"ProductRating.ReportModal"}))},this.handleReportRating=()=>{if(this.props.accountInfoProgress!==L.Z.INIT&&this.props.accountInfoProgress!==L.Z.REQ)if(this.props.accountStatus!==f.d.LOGGED_IN)this.props.history.push((0,R.FK)(y.D_.getUrl(),{next:location.href}));else{const{rating:e}=this.props;if(e){if(this.setState({reportAbuseToggle:!1}),e.is_hidden)return void this.toastAbuseReportSuccess(!0);this.showReportForm()}}},this.toastAbuseReportSuccess=e=>{this.setState({reportAbuseToast:e})},this.clickOutsideToCloseReportMenu=e=>{this._nodeReportMenuButton&&!this._nodeReportMenuButton.contains(e.target)&&this.setState({reportAbuseToggle:!1})},this.openReportAbuseMenu=()=>{this.setState({reportAbuseToggle:!0})},this.getActionButtons=()=>{const{isMyRating:e,rating:t,isFollowUp:r}=this.props;if(e)if(r){if((e=>!!e.can_follow_up)(t))return n.createElement("div",{onClick:this.handleFollow,className:"shopee-product-rating__action-button-primary"},Ie("add_updates"))}else if(1===t.editable)return n.createElement("div",{onClick:this.handleEdit,className:"shopee-product-rating__action-button-con"},n.createElement(V,null),n.createElement("div",{className:"shopee-product-rating__action-button-con--text"},Ie("pr_order_purchase_label_edit")));return null},this.state={reportAbuseToggle:!1,reportAbuseToast:!1,liked:e.rating.liked,like_count:e.rating.like_count}}componentDidMount(){window.document.addEventListener("click",this.clickOutsideToCloseReportMenu)}componentWillUnmount(){window.document.removeEventListener("click",this.clickOutsideToCloseReportMenu)}render(){var e;const{rating:t,noAction:r,productItems:a,itemId:o,isUserRating:s,defaultRatingReviewTemplate:i,accountInfo:l,isMyRating:c,isFollowUp:m}=this.props,{ItemRatingReply:u,UserRatingReply:d,author_portrait:h,author_username:g,anonymous:_,rating_star:f,comment:k,images:y,videos:R,ctime:I,is_hidden:L,author_shopid:N,sip_info:M,is_repeated_purchase:S,editable:F}=t,B=M&&M.origin_region&&M.is_oversea?E.N5[M.origin_region.toLowerCase()]||M.origin_region:null,P=s?d:u,T=!!P&&P.comment,Z=[...R||[],...y||[]],V=a&&a.find((e=>e.itemid===o)),W=!!l&&!!t&&!!t.author_username&&l.userId===t.userid;return n.createElement("div",{className:"shopee-product-rating"},n.createElement(A,{isAnonymous:_,authorPic:h,shopId:N}),n.createElement("div",{className:"shopee-product-rating__main"},n.createElement(O,{isAnonymous:_,authorName:g,shopId:N}),n.createElement("div",{className:"repeat-purchase-con"},n.createElement(H,{star:f}),S?n.createElement("div",{className:"repeat-purchase-area"},n.createElement("div",{className:"delimiter"},"|"),n.createElement(X,null),n.createElement("div",{className:"writing"},Ie("label_repeat_purchase"))):null),n.createElement(G,{modelName:null==V?void 0:V.model_name,region:B,commentTime:(0,b.mr)(I,"yyyy-MM-dd hh:mm"),isUserRating:this.props.isUserRating}),i?n.createElement(E.tD,{isHidden:L,comment:k,templateTags:t.template_tags||[],hasTemplateTag:!!t.has_template_tag}):n.createElement(U,{isHidden:L,content:k}),Z.length&&!L?n.createElement(D,{images:Z}):null,this.props.defaultRatingLowLogistic&&t.exclude_scoring_due_low_logistic?n.createElement(xe,{isProductRatingPage:!this.props.showProducts}):null,T?n.createElement(C.Z,{isHidden:P.is_hidden,response:P.comment,titleText:Ie(s?"label_buyer_response":"label_seller_response")}):null,!L&&m&&(e=>!!e.follow_up)(t)&&null!=(e=t.follow_up)&&e.ctime?n.createElement(Re,{followUp:t.follow_up}):null,this.props.showProducts&&this.props.productItems&&this.props.productItems.map((e=>n.createElement(ye,{key:e.modelid,productItem:e}))),M&&M.is_oversea?n.createElement("div",{className:"shopee-product-rating__time"},Ie("label_auto_translated")):null,!r&&n.createElement("div",{className:"shopee-product-rating__actions",style:{justifyContent:"space-between"}},n.createElement("div",{style:{display:"flex"}},c&&t.show_view&&n.createElement(n.Fragment,null,n.createElement("div",{className:"shopee-product-rating__view-button"},n.createElement(K,null)),n.createElement("div",{className:"shopee-product-rating__view-count"},t.viewed?Le(t.viewed):0)),n.createElement("div",{className:p()("shopee-product-rating__like-button",this.state.liked&&"shopee-product-rating__like-button--liked"),onClick:this.handleLikeRating},n.createElement($,null)),n.createElement("div",{className:"shopee-product-rating__like-count"},this.state.like_count?Le(this.state.like_count):Ie("label_helpful_questionmark"))),n.createElement("div",{style:{display:"flex"}},this.getActionButtons(),W?null:n.createElement("div",{className:"shopee-product-rating__report-menu-button",ref:e=>{this._nodeReportMenuButton=e}},n.createElement(w.Z,{body:n.createElement("div",{className:"shopee-product-rating__report-menu-dropdown",onClick:this.handleReportRating},Ie("label_report_abuse")),header:n.createElement("div",{onClick:this.openReportAbuseMenu},n.createElement(j,null)),open:this.state.reportAbuseToggle}),this.state.reportAbuseToast?n.createElement(v.ZP,{showToast:!0,onToastDismiss:()=>{this.toastAbuseReportSuccess(!1)}},n.createElement("div",{className:p()("shopee-product-rating__report-success-toast",L&&"shopee-product-rating__report-error-toast")},n.createElement("div",{className:p()(!L&&"shopee-product-rating__report-success-icon",L&&"shopee-product-rating__report-error-icon")},L?n.createElement(q,null):n.createElement(x.Z,null)),Ie(L?"hidden_rating_report_toast":"rating_report_successful_toast"))):null)))))}}Ne.contextTypes={dismissPopup:s().func,showPopup:s().func};const Me=(0,i.compose)(c.withRouter,(0,_.u)({fetchOnMount:!0}),(0,l.connect)((e=>({defaultRatingLowLogistic:(0,g.Au)(e.featureToggles,I.__7,!1),defaultRatingReviewTemplate:(0,g.Au)(e.featureToggles,E.aJ,!1),isFollowUp:(0,g.Au)(e.featureToggles,E.q3,!1)})),((e,t)=>({updateMyReview:(t,r,n)=>e((0,h._X)(t,r,n))}))))(Ne)}}]);
//# sourceMappingURL=https://sourcemap.webfe.shopeemobile.com/pcmall-shoprating/_/798.ee0e13bf4cadc54e9ce0.js.map